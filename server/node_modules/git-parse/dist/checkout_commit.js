"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _util = _interopRequireDefault(require("util.promisify"));

var _child_process = _interopRequireDefault(require("child_process"));

var _util2 = require("./util");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const exec = (0, _util.default)(_child_process.default.exec);

/**
 * Checks out a commit given its repo and hash.
 *
 * Returns void. Throws error on failure.
 */
const checkoutCommit = async (pathToRepo, hash, options = {
  force: false
}) => {
  const resolvedPath = (0, _util2.resolveHome)(pathToRepo);

  try {
    (0, _util2.validatePath)(resolvedPath);
  } catch (e) {
    return Promise.reject(e);
  }

  return exec(`git checkout ${hash} ${options.force ? "--force" : ""}`, {
    cwd: resolvedPath
  });
};

var _default = checkoutCommit;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9jaGVja291dF9jb21taXQudHMiXSwibmFtZXMiOlsiZXhlYyIsImNoaWxkUHJvY2VzcyIsImNoZWNrb3V0Q29tbWl0IiwicGF0aFRvUmVwbyIsImhhc2giLCJvcHRpb25zIiwiZm9yY2UiLCJyZXNvbHZlZFBhdGgiLCJlIiwiUHJvbWlzZSIsInJlamVjdCIsImN3ZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOzs7O0FBRUEsTUFBTUEsSUFBSSxHQUFHLG1CQUFVQyx1QkFBYUQsSUFBdkIsQ0FBYjs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTUUsY0FBYyxHQUFHLE9BQ3JCQyxVQURxQixFQUVyQkMsSUFGcUIsRUFHckJDLE9BQStCLEdBQUc7QUFBRUMsRUFBQUEsS0FBSyxFQUFFO0FBQVQsQ0FIYixLQUlsQjtBQUNILFFBQU1DLFlBQVksR0FBRyx3QkFBWUosVUFBWixDQUFyQjs7QUFFQSxNQUFJO0FBQ0YsNkJBQWFJLFlBQWI7QUFDRCxHQUZELENBRUUsT0FBT0MsQ0FBUCxFQUFVO0FBQ1YsV0FBT0MsT0FBTyxDQUFDQyxNQUFSLENBQWVGLENBQWYsQ0FBUDtBQUNEOztBQUVELFNBQU9SLElBQUksQ0FBRSxnQkFBZUksSUFBSyxJQUFHQyxPQUFPLENBQUNDLEtBQVIsR0FBZ0IsU0FBaEIsR0FBNEIsRUFBRyxFQUF4RCxFQUEyRDtBQUNwRUssSUFBQUEsR0FBRyxFQUFFSjtBQUQrRCxHQUEzRCxDQUFYO0FBR0QsQ0FoQkQ7O2VBa0JlTCxjIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHByb21pc2lmeSBmcm9tIFwidXRpbC5wcm9taXNpZnlcIjtcbmltcG9ydCBjaGlsZFByb2Nlc3MgZnJvbSBcImNoaWxkX3Byb2Nlc3NcIjtcbmltcG9ydCB7IHZhbGlkYXRlUGF0aCwgcmVzb2x2ZUhvbWUgfSBmcm9tIFwiLi91dGlsXCI7XG5cbmNvbnN0IGV4ZWMgPSBwcm9taXNpZnkoY2hpbGRQcm9jZXNzLmV4ZWMpO1xuXG5leHBvcnQgaW50ZXJmYWNlIENoZWNrb3V0Q29tbW1pdE9wdGlvbnMge1xuICBmb3JjZT86IGJvb2xlYW4gfCB1bmRlZmluZWQ7XG59XG5cbi8qKlxuICogQ2hlY2tzIG91dCBhIGNvbW1pdCBnaXZlbiBpdHMgcmVwbyBhbmQgaGFzaC5cbiAqXG4gKiBSZXR1cm5zIHZvaWQuIFRocm93cyBlcnJvciBvbiBmYWlsdXJlLlxuICovXG5jb25zdCBjaGVja291dENvbW1pdCA9IGFzeW5jIChcbiAgcGF0aFRvUmVwbzogc3RyaW5nLFxuICBoYXNoOiBzdHJpbmcsXG4gIG9wdGlvbnM6IENoZWNrb3V0Q29tbW1pdE9wdGlvbnMgPSB7IGZvcmNlOiBmYWxzZSB9XG4pID0+IHtcbiAgY29uc3QgcmVzb2x2ZWRQYXRoID0gcmVzb2x2ZUhvbWUocGF0aFRvUmVwbyk7XG5cbiAgdHJ5IHtcbiAgICB2YWxpZGF0ZVBhdGgocmVzb2x2ZWRQYXRoKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlKTtcbiAgfVxuXG4gIHJldHVybiBleGVjKGBnaXQgY2hlY2tvdXQgJHtoYXNofSAke29wdGlvbnMuZm9yY2UgPyBcIi0tZm9yY2VcIiA6IFwiXCJ9YCwge1xuICAgIGN3ZDogcmVzb2x2ZWRQYXRoLFxuICB9KTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNoZWNrb3V0Q29tbWl0O1xuIl19