"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.validatePath = exports.resolveHome = void 0;

var _fs = require("fs");

var _path = require("path");

const resolveHome = filepath => {
  if (filepath[0] === "~") {
    const restOfPath = filepath.slice(1);
    if (typeof process.env.HOME !== "string") throw new Error("HOME environment variable is missing");
    const home = process.env.HOME;
    return (0, _path.join)(home, restOfPath);
  }

  return filepath;
};

exports.resolveHome = resolveHome;

const validatePath = resolvedPath => {
  if (!(0, _fs.existsSync)(resolvedPath)) {
    throw new Error(`The path ${resolvedPath} was not found`);
  }

  if (!(0, _fs.existsSync)((0, _path.join)(resolvedPath, ".git"))) {
    throw new Error(`The directory ${resolvedPath} does not appear to be the root of a git repository.`);
  }
};

exports.validatePath = validatePath;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy91dGlsLnRzIl0sIm5hbWVzIjpbInJlc29sdmVIb21lIiwiZmlsZXBhdGgiLCJyZXN0T2ZQYXRoIiwic2xpY2UiLCJwcm9jZXNzIiwiZW52IiwiSE9NRSIsIkVycm9yIiwiaG9tZSIsInZhbGlkYXRlUGF0aCIsInJlc29sdmVkUGF0aCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUVPLE1BQU1BLFdBQVcsR0FBSUMsUUFBRCxJQUFzQjtBQUMvQyxNQUFJQSxRQUFRLENBQUMsQ0FBRCxDQUFSLEtBQWdCLEdBQXBCLEVBQXlCO0FBQ3ZCLFVBQU1DLFVBQWtCLEdBQUdELFFBQVEsQ0FBQ0UsS0FBVCxDQUFlLENBQWYsQ0FBM0I7QUFDQSxRQUFJLE9BQU9DLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxJQUFuQixLQUE0QixRQUFoQyxFQUNFLE1BQU0sSUFBSUMsS0FBSixDQUFVLHNDQUFWLENBQU47QUFDRixVQUFNQyxJQUFJLEdBQUdKLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxJQUF6QjtBQUNBLFdBQU8sZ0JBQUtFLElBQUwsRUFBV04sVUFBWCxDQUFQO0FBQ0Q7O0FBQ0QsU0FBT0QsUUFBUDtBQUNELENBVE07Ozs7QUFXQSxNQUFNUSxZQUFZLEdBQUlDLFlBQUQsSUFBMEI7QUFDcEQsTUFBSSxDQUFDLG9CQUFXQSxZQUFYLENBQUwsRUFBK0I7QUFDN0IsVUFBTSxJQUFJSCxLQUFKLENBQVcsWUFBV0csWUFBYSxnQkFBbkMsQ0FBTjtBQUNEOztBQUVELE1BQUksQ0FBQyxvQkFBVyxnQkFBS0EsWUFBTCxFQUFtQixNQUFuQixDQUFYLENBQUwsRUFBNkM7QUFDM0MsVUFBTSxJQUFJSCxLQUFKLENBQ0gsaUJBQWdCRyxZQUFhLHNEQUQxQixDQUFOO0FBR0Q7QUFDRixDQVZNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZXhpc3RzU3luYyB9IGZyb20gXCJmc1wiO1xuaW1wb3J0IHsgam9pbiB9IGZyb20gXCJwYXRoXCI7XG5cbmV4cG9ydCBjb25zdCByZXNvbHZlSG9tZSA9IChmaWxlcGF0aDogc3RyaW5nKSA9PiB7XG4gIGlmIChmaWxlcGF0aFswXSA9PT0gXCJ+XCIpIHtcbiAgICBjb25zdCByZXN0T2ZQYXRoOiBzdHJpbmcgPSBmaWxlcGF0aC5zbGljZSgxKTtcbiAgICBpZiAodHlwZW9mIHByb2Nlc3MuZW52LkhPTUUgIT09IFwic3RyaW5nXCIpXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJIT01FIGVudmlyb25tZW50IHZhcmlhYmxlIGlzIG1pc3NpbmdcIik7XG4gICAgY29uc3QgaG9tZSA9IHByb2Nlc3MuZW52LkhPTUU7XG4gICAgcmV0dXJuIGpvaW4oaG9tZSwgcmVzdE9mUGF0aCk7XG4gIH1cbiAgcmV0dXJuIGZpbGVwYXRoO1xufTtcblxuZXhwb3J0IGNvbnN0IHZhbGlkYXRlUGF0aCA9IChyZXNvbHZlZFBhdGg6IHN0cmluZykgPT4ge1xuICBpZiAoIWV4aXN0c1N5bmMocmVzb2x2ZWRQYXRoKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgVGhlIHBhdGggJHtyZXNvbHZlZFBhdGh9IHdhcyBub3QgZm91bmRgKTtcbiAgfVxuXG4gIGlmICghZXhpc3RzU3luYyhqb2luKHJlc29sdmVkUGF0aCwgXCIuZ2l0XCIpKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBUaGUgZGlyZWN0b3J5ICR7cmVzb2x2ZWRQYXRofSBkb2VzIG5vdCBhcHBlYXIgdG8gYmUgdGhlIHJvb3Qgb2YgYSBnaXQgcmVwb3NpdG9yeS5gXG4gICAgKTtcbiAgfVxufTtcbiJdfQ==